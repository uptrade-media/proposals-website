<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Uptrade Sales</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L2 7l10 5 10-5-10-5z"/>
          <path d="M2 17l10 5 10-5"/>
          <path d="M2 12l10 5 10-5"/>
        </svg>
        <span>Uptrade Sales</span>
      </div>
      <button id="settingsBtn" class="icon-btn" title="Settings">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
    </header>

    <!-- Login View -->
    <div id="loginView" class="view">
      <div class="login-card">
        <h2>Sign In</h2>
        <p>Connect to your Uptrade Portal account</p>
        <button id="loginBtn" class="btn btn-primary btn-full">
          Sign in with Portal
        </button>
        <p class="help-text">
          Don't have access? <a href="https://portal.uptrademedia.com" target="_blank">Request access</a>
        </p>
      </div>
    </div>

    <!-- Main View -->
    <div id="mainView" class="view hidden">
      <!-- Domain Info -->
      <div id="domainCard" class="card">
        <div class="domain-header">
          <div class="domain-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="2" y1="12" x2="22" y2="12"/>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </div>
          <div class="domain-info">
            <h3 id="domainName">Loading...</h3>
            <span id="domainStatus" class="status-badge">Checking...</span>
          </div>
        </div>
      </div>

      <!-- Tech Stack -->
      <div id="techStackCard" class="card">
        <h4>Tech Stack</h4>
        <div id="techStackList" class="tech-stack-list">
          <span class="placeholder">Detecting...</span>
        </div>
      </div>

      <!-- Quick Signals -->
      <div id="signalsCard" class="card">
        <h4>Quick Signals</h4>
        <div id="signalsList" class="signals-grid">
          <!-- Populated by JS -->
        </div>
      </div>

      <!-- Analyze Button (before analysis) -->
      <div id="analyzeSection" class="action-section">
        <button id="analyzeBtn" class="btn btn-primary btn-full">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
          </svg>
          Analyze Site
        </button>
      </div>

      <!-- Score Card (after analysis) -->
      <div id="scoreCard" class="card hidden">
        <div class="score-header">
          <div class="score-circle" id="scoreCircle">
            <span id="scoreValue">--</span>
          </div>
          <div class="score-info">
            <span id="scoreLabel" class="score-label">Not Analyzed</span>
            <p id="scoreSummary" class="score-summary"></p>
          </div>
        </div>
        
        <!-- Top Factors -->
        <div id="topFactors" class="factors-list hidden">
          <h5>Why this score</h5>
          <ul id="factorsList"></ul>
        </div>

        <!-- Pitch Angles -->
        <div id="pitchAngles" class="pitch-list hidden">
          <h5>Pitch Angles</h5>
          <div id="anglesList"></div>
        </div>
      </div>

      <!-- Audit Section -->
      <div id="auditSection" class="card hidden">
        <h4>Site Audit</h4>
        <div id="auditContent">
          <button id="runAuditBtn" class="btn btn-secondary btn-full">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10 9 9 9 8 9"/>
            </svg>
            Run Audit
          </button>
        </div>
        
        <!-- Audit Loading -->
        <div id="auditLoading" class="hidden">
          <div class="loading-spinner"></div>
          <p>Running audit... (30-60 seconds)</p>
        </div>
        
        <!-- Audit Results -->
        <div id="auditResults" class="hidden">
          <div class="audit-scores">
            <div class="audit-score">
              <span class="audit-score-value" id="perfScore">--</span>
              <span class="audit-score-label">Performance</span>
            </div>
            <div class="audit-score">
              <span class="audit-score-value" id="seoScore">--</span>
              <span class="audit-score-label">SEO</span>
            </div>
            <div class="audit-score">
              <span class="audit-score-value" id="a11yScore">--</span>
              <span class="audit-score-label">Accessibility</span>
            </div>
            <div class="audit-score">
              <span class="audit-score-value" id="bpScore">--</span>
              <span class="audit-score-label">Best Practices</span>
            </div>
          </div>
          <div class="audit-actions">
            <button id="viewAuditBtn" class="btn btn-outline btn-sm">
              View Audit
            </button>
            <button id="sendAuditBtn" class="btn btn-primary btn-sm">
              Send Audit
            </button>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div id="actionsSection" class="action-section hidden">
        <button id="sendOutreachBtn" class="btn btn-primary btn-full">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
          </svg>
          Generate Outreach Email
        </button>
        <button id="saveProspectBtn" class="btn btn-secondary btn-full">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/>
            <polyline points="7 3 7 8 15 8"/>
          </svg>
          Save to Portal
        </button>
      </div>

      <!-- Found Contacts -->
      <div id="contactsCard" class="card hidden">
        <div class="contacts-header">
          <h4>Found Contacts</h4>
          <button id="saveContactsBtn" class="btn btn-sm">Save All</button>
        </div>
        <div id="contactsList" class="contacts-list">
          <!-- Populated by JS -->
        </div>
      </div>
    </div>

    <!-- Email Preview Modal -->
    <div id="emailModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Outreach Email</h3>
          <button id="closeEmailModal" class="icon-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>To:</label>
            <input type="email" id="emailTo" placeholder="recipient@company.com">
          </div>
          <div class="form-group">
            <label>Subject:</label>
            <input type="text" id="emailSubject" readonly>
          </div>
          <div class="form-group">
            <label>Body:</label>
            <textarea id="emailBody" rows="10" readonly></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button id="copyEmailBtn" class="btn btn-secondary">
            Copy to Clipboard
          </button>
          <button id="openGmailBtn" class="btn btn-primary">
            Open in Gmail
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Settings</h3>
          <button id="closeSettingsModal" class="icon-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="user-info" id="userInfo">
            <p>Signed in as: <strong id="userEmail">--</strong></p>
          </div>
          <div class="form-group">
            <label>Scheduling URL:</label>
            <input type="url" id="schedulingUrl" placeholder="https://cal.com/your-link">
          </div>
          <div class="form-group">
            <label>Email Tone:</label>
            <select id="emailTone">
              <option value="professional">Professional</option>
              <option value="friendly">Friendly</option>
              <option value="direct">Direct</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="logoutBtn" class="btn btn-danger">
            Sign Out
          </button>
          <button id="saveSettingsBtn" class="btn btn-primary">
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
      <span id="toastMessage"></span>
    </div>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
